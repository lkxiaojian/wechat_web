<!--头部导航信息-->
<div class="modal-header">
    <div class="btn pull-right m-t-n-xs m-l-n list-icon">
        <a ui-sref="app.insure.integration_processManage"> <i
                class="fa fa-mail-reply-all"></i>
        </a>
    </div>
    <div style="margin: 0px 15px">
        <h3 class="m-n font-thin h5">{{listObj.navigationMsg}} </h3>
    </div>
</div>

<!--内容区-->
<div class="wrapper-md">
    <tabset class="tab-container">
        <!--第一步：添加文章-->
        <tab active="steps.step1" select="steps.percent=50">
            <tab-heading>
                添加文章
            </tab-heading>
            <progressbar value="steps.percent" class="progress-xs" type="success"></progressbar>
            <div class="modal-body">
                <form class="form-horizontal m-b-md" id="add_integration"
                      name="addIntegrationFormValidate" novalidate>



                    <div class="form-group">
                        <label class="col-lg-2 col-md-2 col-sm-2 control-label padder-l-0"><span
                                class="text-danger m-r-xs font-bold as-star"></span>领域</label>
                        <div class="col-lg-4 col-md-4 col-sm-4">
                            <ui-select ng-model="listObj.region.selected"
                                       on-select="listObj.getRegionSelect($item)"
                                       theme="bootstrap">
                                <ui-select-match
                                        placeholder="{{'请选择领域' | translate}}">
                                    {{$select.selected.article_type_name}}
                                </ui-select-match>
                                <ui-select-choices group-by="'group'"
                                                   repeat="item in listObj.projectData | filter: $select.search">
                                    <span ng-bind-html="item.article_type_name | highlight: $select.search"></span>
                                </ui-select-choices>
                            </ui-select>
                        </div>


                        <label class="col-lg-1 col-md-1 col-sm-1 control-label padder-l-0"><span
                                class="text-danger m-r-xs font-bold as-star">*</span>类型</label>
                        <div class="col-lg-4 col-md-4 col-sm-4" >
                            <ui-select ng-model="alistObj.regionType.selected"
                                       on-select="listObj.getRegionTypeSelect($item)"
                                       theme="bootstrap">

                                <ui-select-match
                                        placeholder="{{'请选择文章类型' | translate}}">
                                    {{$select.selected.article_type_name}}
                                </ui-select-match>
                                <ui-select-choices group-by="'group'"
                                                   repeat="item in listObj.articleTyprData | filter: $select.search">
                                    <span ng-bind-html="item.article_type_name | highlight: $select.search"></span>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </div>


                    <div class="form-group">
                        <label class="col-lg-2 col-md-2 col-sm-2 control-label padder-l-0"><span
                                class="text-danger m-r-xs font-bold as-star">*</span>进程名</label>
                        <div class="col-lg-10 col-md-10 col-sm-10">
                            <input type="text" class="form-control" name="itName"
                                   ng-model="addIntegrationObj.addData.int_name" value="请输入进程名称"
                                   ng-maxlength="50" id="policy_name" required/>
                            <div class="error"
                                 ng-show="addIntegrationFormValidate.itName.$dirty && addIntegrationFormValidate.itName.$invalid">
                                <small class="error a-red"
                                       ng-show="addIntegrationFormValidate.itName.$error.required">
                                    请输入进程名
                                </small>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-lg-2 col-md-2 col-sm-2 control-label padder-l-0"><span
                                class="text-danger m-r-xs font-bold as-star">*</span>版本</label>
                        <div class="col-lg-10 col-md-10 col-sm-10">
                            <input type="text" class="form-control" name="itVersion"
                                   ng-maxlength="50" id="policy_code" value="请输入版本"
                                   ng-disabled="addIntegrationObj.param =='update'"
                                   ng-model="addIntegrationObj.addData.int_version" required/>
                            <div class="error"
                                 ng-show="addIntegrationFormValidate.itVersion.$dirty && addIntegrationFormValidate.itVersion.$invalid">
                                <small class="error a-red"
                                       ng-show="addIntegrationFormValidate.itVersion.$error.required">
                                    请输入版本
                                </small>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-lg-2 col-md-2 col-sm-2 control-label padder-l-0"><span
                                class="text-danger m-r-xs font-bold as-star">*</span>产品</label>
                        <div class="col-lg-10 col-md-10 col-sm-10">
                            <ui-select ng-change="listObj.getTypeSelect(addIntegrationObj.addData.int_project_type)"

                                       ng-model="addIntegrationObj.addData.int_project_type" theme="bootstrap">
                                <ui-select-match value="请选择产品">
                                    {{$select.selected.name}}
                                </ui-select-match>
                                <ui-select-choices group-by="'group'"
                                                   repeat="item in listObj.projectData | filter: $select.search">
                                    <span ng-bind-html="item.name | highlight: $select.search"></span>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </div>


                    <hr class="b-l-light">

                    <div class="form-group">
                        <label class="col-lg-2 col-md-2 col-sm-2 control-label padder-l-0"><span
                                class="text-danger m-r-xs font-bold as-star"></span>版本说明</label>
                        <div class="col-lg-10 col-md-10 col-sm-10">
				<textarea class="form-control" rows="3"
                          ng-model="addIntegrationObj.addData.int_version_explain" value="请输入版本说明"
                          name="special_appointment" id="special_appointment"></textarea>
                        </div>
                    </div>


                </form>
            </div>
            <div class="modal-footer">
                <span class="_color_red pull-left">{{error_msg}}</span>
                <button type="button" class="btn btn-default btn-rounded"
                        ng-disabled="addIntegrationFormValidate.$invalid" ng-click="steps.step2=true">下一步
                </button>
            </div>
        </tab>
        <!--第二步：文章列表-->
        <tab disable="addIntegrationObj.param === 'add' && !steps.step2" active="steps.step2" select="steps.percent=100">
            <tab-heading>
                文章列表
            </tab-heading>
            <progressbar value="steps.percent" class="progress-xs" type="success"></progressbar>
            <div class="modal-body">
                <div class="hbox hbox-auto-xs hbox-auto-sm" ng-controller="FileUploadCtrl" nv-file-drop=""
                     uploader="uploader" filters="queueLimit, customFilter">
                    <div class="col w-lg bg-light b-r bg-auto">
                        <div class="wrapper-md dker b-b">
                            <h5 class="m-n font-bold">文件选择区</h5>
                        </div>
                        <div class="wrapper-md">
                            <div ng-show="uploader.isHTML5" class="m-b-md">
                                <!-- 3. nv-file-over uploader="link" over-class="className" -->
                                <div class="b-a b-2x b-dashed wrapper-lg bg-white text-center m-b" nv-file-over=""
                                     over-class="b-info" uploader="uploader">
                                    将文件托至此
                                </div>

                            </div>

                            <!-- Example: nv-file-select="" uploader="{Object}" options="{Object}" filters="{String}" -->
                            <p>手动添加</p>
                            <input type="file" nv-file-select="" uploader="uploader" multiple/>

                        </div>
                    </div>
                    <div class="col">
                        <div class="wrapper-md bg-light dk b-b">
                            <span class="pull-right m-t-xs">文件个数: <b
                                    class="badge bg-info">{{ uploader.queue.length }}</b></span>
                            <h5 class="m-n font-bold">上传文件区</h5>
                        </div>
                        <div class="wrapper-md">
                            <table class="table bg-white-only b-a">
                                <thead>
                                <tr>
                                    <th width="50%">文件名</th>
                                    <th ng-show="uploader.isHTML5">大小</th>
                                    <th ng-show="uploader.isHTML5">进度</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr ng-repeat="item in uploader.queue">
                                    <td width="50%"><strong>{{ item.file.name }}</strong></td>
                                    <td ng-show="uploader.isHTML5" nowrap>{{ item.file.size/1024/1024|number:3 }} MB
                                    </td>
                                    <td ng-show="uploader.isHTML5">
                                        <div class="progress progress-sm m-b-none m-t-xs">
                                            <div class="progress-bar bg-info" role="progressbar"
                                                 ng-style="{ 'width': item.progress + '%' }"></div>
                                        </div>
                                    </td>
                                    <td class="text-center">
                                        <span ng-show="item.isSuccess" class="text-success"><i
                                                class="glyphicon glyphicon-ok"></i></span>
                                        <span ng-show="item.isCancel" class="text-warning"><i
                                                class="glyphicon glyphicon-ban-circle"></i></span>
                                        <span ng-show="item.isError" class="text-danger"><i
                                                class="glyphicon glyphicon-remove"></i></span>
                                    </td>
                                    <td nowrap>
                                        <button type="button" class="btn btn-default btn-xs" ng-click="item.upload()"
                                                ng-disabled="item.isReady || item.isUploading || item.isSuccess">
                                            上传
                                        </button>
                                        <button type="button" class="btn btn-default btn-xs" ng-click="item.cancel()"
                                                ng-disabled="!item.isUploading">
                                            取消
                                        </button>
                                        <button type="button" class="btn btn-default btn-xs" ng-click="item.remove()">
                                            移除
                                        </button>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                            <div>
                                <div>
                                    <p>总上传进度:</p>
                                    <div class="progress bg-light dker" style="">
                                        <div class="progress-bar progress-bar-striped bg-info" role="progressbar"
                                             ng-style="{ 'width': uploader.progress + '%' }"></div>
                                    </div>
                                </div>
                                <button type="button" class="btn btn-addon btn-success" ng-click="uploader.uploadAll()"
                                        ng-disabled="!uploader.getNotUploadedItems().length">
                                    <i class="fa fa-arrow-circle-o-up"></i> 一键上传
                                </button>
                                <button type="button" class="btn btn-addon btn-warning" ng-click="uploader.cancelAll()"
                                        ng-disabled="!uploader.isUploading">
                                    <i class="fa fa-ban"></i> 一键取消
                                </button>
                                <button type="button" class="btn btn-addon btn-danger" ng-click="uploader.clearQueue()"
                                        ng-disabled="!uploader.queue.length">
                                    <i class="fa fa-trash-o"></i> 一键移除
                                </button>
                            </div>
                        </div>
                    </div>
                </div>


            </div>
            <div class="modal-footer">
                <span class="_color_red pull-left">{{error_msg}}</span>
                <button type="button" class="btn btn-default btn-rounded"
                        ng-click="steps.step1=true">上一步
                </button>
                <button type="button" class="btn btn-default btn-rounded"
                        ng-click="steps.step3=true&&addIntegrationObj.getTableForSrc()">下一步
                </button>
            </div>

        </tab>

    </tabset>

</div>


<script type="text/ng-template" id="myModalContent.html">
    <div id="mapModel" ng-include="'insure/template/policy/mapAddressmodal.html'"></div>
</script>

